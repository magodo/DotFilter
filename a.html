<h1>DotFilter: a simple filter to extract interested part of dot file</h1>

<ul>
<li><a href="#intro">Intro</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#user-guide---bitbake">User Guide - bitbake</a></li>
<li><a href="#user-guide---systemd">User Guide - systemd</a></li>
<li><a href="#license">License</a></li>
</ul>

<h2>Intro</h2>

<p>DotFilter is a simple tool for filter out interested part of a complicated dot file. </p>

<p>Currently supported dot file origins are from:</p>

<ul>
<li><a href="http://www.yoctoproject.org/docs/2.0.1/ref-manual/ref-manual.html#usingpoky-debugging-dependencies">bitbake dot</a></li>
<li><a href="http://www.freedesktop.org/software/systemd/man/systemd-analyze.html">systemd-analyze dot</a></li>
</ul>

<p>Each one has a correspoding laucher script under <strong>bin</strong> directory.</p>

<p>The input to script is an existed <strong>raw</strong> dot file;</p>

<p>The output is a <strong>filtered</strong> dot file;</p>

<p>DotFilter allows you to do several kinds of customization:</p>

<ul>
<li>Indicate from which node to view(regexp supported)</li>
<li>Indicate to which node to view(regexp supported)</li>
<li>Indicate nodes with which attribute to view</li>
</ul>

<h2>Installation</h2>

<p><strong>Note: It is only tested on Ubuntu 12.04-lts now</strong></p>

<p>Firstly, make sure you have graphviz installed:</p>

<pre><code>sudo apt-get install graphviz
</code></pre>

<p>Secondly, copy script to any location where you have access right.</p>

<h2>User Guide - bitbake</h2>

<h3>Get Input File</h3>

<p>Run following command in devkits to get input file:</p>

<pre><code>bitbake -g &lt;target-name&gt;
</code></pre>

<h3>Extract intrested part of dot file</h3>

<p>Run following command to extract interested part of dot file and output a customized version:</p>

<pre><code>usage: bitbake_filter.py           [-h] [--from-node FROMNODE]
                                   [--to-node TONODE]
                                   [--filter [{rdepends,depends} [{rdepends,depends} ...]]]
                                   [--output OUTPUT]
                                   input

positional arguments:
  input

optional arguments:
  -h, --help            show this help message and exit
  --from-node FROMNODE  From which node to extract(regexp supported)
  --to-node TONODE      To which node to extract(regexp supported)
  --filter [{rdepends,depends} [{rdepends,depends} ...]]
                        Which kind of transitions do you want to view
  --output OUTPUT, -o OUTPUT
                        Output filtered dot file
</code></pre>

<p>E.g. <code>./bitbake_filter.py --from-node ".*conn-connectivity.*app.*" --to-node ".*.hmi.*" --filter depends rdepends --output ../test/pn-depends_output.dot ../test/pn-depends.dot</code></p>

<p>You could then get a dot file <code>../test/pn-depends_output.dot</code> which contains only nodes started from nodes match pattern <code>.*conn-connectivity.*app.*</code> and to nodes match pattern <code>.*.hmi.*</code> and only show information about <code>depends</code> and <code>rdepends</code>.</p>

<h3>Convert customize dot to svg</h3>

<p>Run following command to convert customized dot file to human-readable picture:</p>

<pre><code>dot -Tsvg &lt;input dot file&gt; &gt; -o &lt;output dot file&gt;
</code></pre>

<p>You can use <code>eog</code> to open this picture. This time you can get clearer picture.</p>

<h2>User Guide - systemd</h2>

<h3>Get Input File</h3>

<p>Run following command on <strong>systemd-init</strong> system to get input file:</p>

<pre><code>systemd-analyze dot &gt; systemd.dot
</code></pre>

<h3>Convert dot to svg</h3>

<p>Run following command to convert to human-readable picture:</p>

<pre><code>dot -Tsvg systemd.dot -o systemd.svg
</code></pre>

<p>You can use <code>eog</code> to open this picture, but you will find it's quite complicated.</p>

<h3>Extract intrested part of dot file</h3>

<p>Run following command to extract interested part of dot file and output a customized version:</p>

<pre><code>usage: systemd_filter.py [-h] [--from-node FROMNODE] [--to-node TONODE]
                         [--filter [{conflicts,after,wants,requires,requisite} [{conflicts,after,wants,requires,requisite} ...]]]
                         [--output OUTPUT]
                         input

positional arguments:
  input

optional arguments:
  -h, --help            show this help message and exit
  --from-node FROMNODE  From which node to extract(regexp supported)
  --to-node TONODE      To which node to extract(regexp supported)
  --filter [{conflicts,after,wants,requires,requisite} [{conflicts,after,wants,requires,requisite} ...]]
                        Which kind of transitions do you want to view
  --output OUTPUT, -o OUTPUT
                        Output filtered dot file
</code></pre>

<p>E.g. <code>./systemd_filter.py --from-node "lazy.target" --filter wants requires --output ../test/systemd_out.dot ../test/systemd.dot</code></p>

<p>You could then get a dot file <code>../test/systemd_out.dot</code> which contains only nodes started from <code>lazy.target</code> and only show information about <code>wants</code> and <code>requires</code>.</p>

<h3>Convert customize dot to svg</h3>

<p>Run following command to convert customized dot file to human-readable picture:</p>

<pre><code>dot -Tsvg &lt;input dot file&gt; &gt; -o &lt;output dot file&gt;
</code></pre>

<p>You can use <code>eog</code> to open this picture. This time you can get clearer picture.</p>

<h2>License</h2>

<p>This software is licensed under the <a href="http://www.gnu.org/copyleft/gpl.html">GPL v3 license</a>.</p>
